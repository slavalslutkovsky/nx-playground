procs:
  # =============================================================================
  # Infrastructure - Start these first
  # =============================================================================
#  infra:
#    shell: "docker compose -f manifests/dockers/compose.yaml up"
#    stop: "SIGTERM"

  # =============================================================================
  # Database Migration - Run after infra is ready
  # =============================================================================
#  migrate:
#    shell: |
#      echo "Waiting for PostgreSQL..."
#      until pg_isready -h localhost -p 5432 -U myuser 2>/dev/null; do
#        sleep 1
#      done
#      echo "Running migrations..."
#      cargo run -p migration -- up
#    stop: "SIGTERM"

  # =============================================================================
  # Rust Services (bacon for hot-reload)
  # =============================================================================
  zerg-api:
    shell: "bacon zerg-api"
    stop: "SIGTERM"

  zerg-tasks:
    shell: "bacon zerg-tasks"
    stop: "SIGTERM"

  zerg-email:
    shell: "bacon zerg-email-nats"
    stop: "SIGTERM"

#  zerg-email-nats:
#    shell: "bacon zerg-email-nats"
#    stop: "SIGTERM"

#  zerg-vector:
#    shell: "bacon zerg-vector"
#    stop: "SIGTERM"

  # =============================================================================
  # Frontend
  # =============================================================================
  zerg-web:
    shell: "bun nx dev zerg-web"
    stop: "SIGTERM"

  # =============================================================================
  # Kubernetes Development
  # =============================================================================
#  tilt:
#    shell: "tilt up"
#    stop: "SIGTERM"

# =============================================================================
# Layout - Organized process grid
# =============================================================================
#layout:
#  kind: horizontal
#  panes:
#    - kind: vertical
#      panes:
#        - infra
#        - migrate
#    - kind: vertical
#      panes:
#        - zerg-api
#        - zerg-tasks
#        - zerg-web
